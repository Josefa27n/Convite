<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Convite</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
body{
  margin:0;
  font-family:'Poppins', Arial, sans-serif;
  display:flex;
  align-items:center;
  justify-content:center;
  height:100vh;
  color:white;
  text-align:center;
  background:black;
}
html, body{
  width:100%;
  height:100%;
  overflow:hidden;
}
.safe-area{
  position: fixed;
  top:10%;
  left:10%;
  width:80%;
  height:80%;
  pointer-events:none;
}
#bg{
  position:fixed;
  inset:0;
  z-index:-2;
  width:100%;
  height:100%;
  object-fit:cover;
  pointer-events:none;
}
.card{
  position:relative;
  background:rgba(0,0,0,0.65);
  backdrop-filter:blur(6px);
  padding:40px 30px;
  border-radius:18px;
  width:340px;
  max-width:90%;
  box-shadow:0 0 20px rgba(0,0,0,0.7);
  overflow:visible;
}
.tremendo{ animation: tremer 1.8s infinite alternate; }
button{
  padding:14px 28px;
  margin:8px;
  font-size:18px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  transition:0.2s;
  font-weight:600;
  position:relative;
}
.sim{ background:linear-gradient(45deg,#00c853,#00e676); color:black; }
.nao{ background:linear-gradient(45deg,#d50000,#ff5252); color:white; }
#nome{ font-size:26px; color:#ffcc00; margin-bottom:10px; }
#pergunta{ font-size:20px; margin-bottom:15px; }
#msg{ font-size:16px; margin-bottom:20px; color:#00e676; }
@keyframes tremer{
  0%{ transform:translate(0,0) rotate(0deg); }
  50%{ transform:translate(1px,-1px) rotate(0.2deg); }
  100%{ transform:translate(-1px,1px) rotate(-0.2deg); }
}
</style>
</head>
<body>

<video id="bg" autoplay muted loop playsinline webkit-playsinline>
  <source src="fundo.mp4" type="video/mp4" media="(min-width: 769px)">
  <source src="fundo-mobile.mp4" type="video/mp4" media="(max-width: 768px)">
</video>

<div class="safe-area" id="safeArea"></div>

<div class="card tremendo">
  <h1 id="nome"></h1>
  <p id="pergunta">VocÃª vai?</p>
  <p id="msg"></p>
  <div class="botoes">
    <button class="sim" id="btnSim" onclick="responder('SIM')">SIM</button>
    <button class="nao" onclick="responder('NAO')">NÃƒO</button>
  </div>
</div>

<script>
const nome = new URLSearchParams(location.search).get("nome") || "Convidado";
document.getElementById("nome").innerText = nome + ",";

const btnSim = document.getElementById("btnSim");
let posInicial = null;

// Captura a posiÃ§Ã£o inicial apÃ³s o botÃ£o renderizar
window.addEventListener("load", () => {
  const rect = btnSim.getBoundingClientRect();
  posInicial = { left: rect.left, top: rect.top };
});

function moverBotao(){
  if(!posInicial) return;
  const margem = 8;
  const bw = btnSim.offsetWidth;
  const bh = btnSim.offsetHeight;
  const btnNao = document.querySelector(".nao");
  const naoRect = btnNao.getBoundingClientRect();

  // Limites mÃ¡ximos relativos Ã  posiÃ§Ã£o inicial
  const minX = posInicial.left - 20;
  const maxX = posInicial.left + 20;
  const minY = posInicial.top - 50;
  const maxY = posInicial.top + 50;

  let x, y;
  let tentativas = 0;

  do {
    x = Math.random() * (maxX - minX) + minX;
    y = Math.random() * (maxY - minY) + minY;
    tentativas++;
    if(tentativas > 50) break;
  } while (
    x > (naoRect.left - bw - margem) &&
    x < (naoRect.right + margem) &&
    y > (naoRect.top - bh - margem) &&
    y < (naoRect.bottom + margem)
  );

  btnSim.style.position = "fixed";
  btnSim.style.left = x + "px";
  btnSim.style.top  = y + "px";
  btnSim.style.margin = "0";
  btnSim.style.zIndex = "999";
}

function ativarFuga(){
  document.addEventListener("mousemove", (e)=>{
    const rect = btnSim.getBoundingClientRect();
    const centroX = rect.left + rect.width/2;
    const centroY = rect.top + rect.height/2;
    const dx = e.clientX - centroX;
    const dy = e.clientY - centroY;
    if(Math.sqrt(dx*dx + dy*dy)<120){
      moverBotao();
    }
  });

  btnSim.addEventListener("touchstart", (e)=>{
    e.preventDefault();
    moverBotao();
  });
  btnSim.addEventListener("mousedown", (e)=>{
    e.preventDefault();
    moverBotao();
  });
}

const etapas = [
  "VocÃª vai?",
  "VocÃª tem certeza?",
  "VocÃª tem certeza absoluta?",
  "Ã‰ sua Ãºltima chance de dizer nÃ£o..."
];
let etapaAtual = 0;

function responder(resp){
  const pergunta = document.getElementById("pergunta");
  const msg = document.getElementById("msg");

  if(resp === "SIM"){
    etapaAtual++;
    if(etapaAtual < etapas.length){
      pergunta.innerText = etapas[etapaAtual];
      if(etapaAtual === etapas.length - 1) ativarFuga();
      return;
    }
  }
  if(resp === "NAO"){
    msg.innerText = "fico triste com uma notÃ­cia dessa ðŸ¥³ðŸŽ‰";
  }
}
</script>

</body>
</html>
